% Define macros for this paper
\newcommand{\snippetsPath}{./Code/Python/snippets}
\makeatletter
\newif\ifdvi\dvitrue
\@ifundefined{pdfoutput}{}{\ifnum\pdfoutput>0 \dvifalse\fi}
\makeatother

% Pile of solved periods (backward induction): typewriter P (computational objects); word macros for prose
% Symbols: \Pile = $\mathtt{P}$, \pile = $\mathtt{p}$; words: \pileName, \PileName, \pilesName, \PilesName
\providecommand{\Pile}{}\renewcommand{\Pile}{\mathtt{P}}
\providecommand{\pile}{}\renewcommand{\pile}{\mathtt{p}}
\providecommand{\pileName}{}\renewcommand{\pileName}{pile}
\providecommand{\PileName}{}\renewcommand{\PileName}{Pile}
\providecommand{\pilesName}{}\renewcommand{\pilesName}{piles}
\providecommand{\PilesName}{}\renewcommand{\PilesName}{Piles}
\providecommand{\PileCode}{}\renewcommand{\PileCode}{\texttt{Pile}}

% LHS is created from RHS; see \ref{subsubsec:builders}
\newcommand{\leftassign}{:=}

% Stage short-name (verbal identifier); uses \textsf for MathJax/KaTeX portability
\newcommand{\StgName}[1]{\textsf{#1}}

% Allow conditional execution depending on whether in subfile or not
\providecommand{\onlyinsubfile}{}\renewcommand{\onlyinsubfile}[1]{#1}
\providecommand{\notinsubfile}{}\renewcommand{\notinsubfile}[1]{}

% Notation for three steps within a stage
\newcommand{\Arrival}{Arrival}          \newcommand{\arvl}{\prec}
\newcommand{\Continuation}{Continuation}\newcommand{\cntn}{\succ}
%% 20240602: 
%% - \dcsn is null so disappears in latex
%% - preserved in case we want to create a middle-of-period marker later
\newcommand{\Decision}{Decision}\newcommand{\dcsn}{\sim}%{\text{--}}%{\text{---}}%{\null}

% providecommand then renewcommand works to redefine macro if it already exists
\providecommand{\prdNxt}{}\renewcommand{\prdNxt}{\prdt+1}
\providecommand{\prdLst}{}\renewcommand{\prdLst}{\prdt-1}
\providecommand{\prdNxT}{}\renewcommand{\prdNxT}{\prdT+1}
\providecommand{\prdLsT}{}\renewcommand{\prdLsT}{\prdT-1}

\providecommand{\BegMark}{}\renewcommand{\BegMark}{\arvl}

% ====== Perch-level subscript macros (Arvl/Dcsn/Cntn) ======
% The three perches within a stage:
%   Arvl  = arrival perch
%   Dcsn  = decision perch
%   Cntn  = continuation perch
\providecommand{\Arvl}{}\renewcommand{\Arvl}{{\arvl}}
\providecommand{\ArvlNxt}{}\renewcommand{\ArvlNxt}{{\arvl(\prdNxt)}}
\providecommand{\ArvlLst}{}\renewcommand{\ArvlLst}{{\arvl(\prdLst)}}

\providecommand{\Dcsn}{}\renewcommand{\Dcsn}{{\dcsn}}
\providecommand{\DcsnNxt}{}\renewcommand{\DcsnNxt}{{\dcsn(\prdNxt)}}
\providecommand{\DcsnLst}{}\renewcommand{\DcsnLst}{{\dcsn(\prdLst)}}
\providecommand{\DcsnLsT}{}\renewcommand{\DcsnLsT}{{\dcsn(\prdLsT)}}

\providecommand{\BegPrd}{}\renewcommand{\BegPrd}{{\arvl(\prdt)}}
\providecommand{\BegPrdNxt}{}\renewcommand{\BegPrdNxt}{{\arvl(\prdt+1)}}
\providecommand{\MidPrdNxt}{}\renewcommand{\MidPrdNxt}{{\dcsn(\prdt+1)}}
\providecommand{\MidPrdNxT}{}\renewcommand{\MidPrdNxT}{{\dcsn(\prdT+1)}}
\providecommand{\BegPrdLst}{}\renewcommand{\BegPrdLst}{{\arvl(\prdt-1)}}
\providecommand{\MidPrdLst}{}\renewcommand{\MidPrdLst}{{\dcsn(\prdt-1)}} 
\providecommand{\BegPrdLsT}{}\renewcommand{\BegPrdLsT}{{\arvl(\prdT-1)}}
\providecommand{\BegPrdNxT}{}\renewcommand{\BegPrdNxT}{{\arvl(\prdT+1)}}
\providecommand{\MidPrdLsT}{}\renewcommand{\MidPrdLsT}{{\dcsn(\prdT-1)}} 

\providecommand{\MidPrd}{}\renewcommand{\MidPrd}{\dcsn(\prd)}
\providecommand{\EndMark}{}\renewcommand{\EndMark}{\cntn}
\providecommand{\Cntn}{}\renewcommand{\Cntn}{{\cntn}}
\providecommand{\EndPrd}{}\renewcommand{\EndPrd}{{\cntn}(\prd)}
\providecommand{\EndPrdLst}{}\renewcommand{\EndPrdLst}{{\cntn}(\prd-1)}   % Lst=Last=t-1
\providecommand{\EndPrdLsT}{}\renewcommand{\EndPrdLsT}{{\cntn}(\prd-1)}   % LsT=T-1
\providecommand{\BegPrdLst}{}\renewcommand{\BegPrdLst}{{\arvl(\prdt-1)}} 
\providecommand{\BegPrdLsT}{}\renewcommand{\BegPrdLsT}{{\arvl(\prdT-1)}} 
\providecommand{\EndPrdNxt}{}\renewcommand{\EndPrdNxt}{{\cntn(\prd+1)}}
% Line below was a bug: providecommand MidPrdNxt but renewcommand EndPrdNxt
% \providecommand{\MidPrdNxt}{}\renewcommand{\EndPrdNxt}{(\prd+1)_{\dcsn}}
\providecommand{\EndPrdNxT}{}\renewcommand{\EndPrdNxT}{{\cntn(\prdT+1)}}
% Value function macros -- primary definitions use Arvl/Dcsn/Cntn
\newcommand{\vArvl}{\vFunc_{\Arvl}}
\newcommand{\vArvlNxt}{\vFunc_{\ArvlNxt}}
\newcommand{\vDcsn}{\vFunc_{\Dcsn}}
\newcommand{\vDcsnNxt}{\vFunc_{\DcsnNxt}}
\newcommand{\vCntn}{\vFunc_{\Cntn}}
\newcommand{\cCntn}{\cFunc_{\Cntn}}
% Period-level (unchanged)
\newcommand{\vBegPrd}{\vFunc_{\BegPrd}}
\newcommand{\vBegPrdNxt}{\vFunc_{\BegPrdNxt}}
\newcommand{\vMidPrdNxt}{\vFunc_{\MidPrdNxt}}
\newcommand{\vEndPrdNxt}{\vFunc_{\EndPrdNxt}}
\newcommand{\vEndPrd}{\vFunc_{\EndPrd}}
\newcommand{\vEndPrdLst}{\vFunc_{\EndPrdLst}}
\newcommand{\vEndPrdLsT}{\vFunc_{\EndPrdLsT}}
\newcommand{\vMidPrdLst}{\vFunc_{\MidPrdLst}}
\newcommand{\vMidPrdLsT}{\vFunc_{\MidPrdLsT}}

% Generic derivative superscripts (used in equations as v^{\dm}, v^{\dcheckm})
\newcommand{\dm}{\partial}
\newcommand{\dcheckm}{\partial}

\providecommand{\PDVCoverc}{\mathbb{C}}

% Allow changing our mind about the names of the ordering elements
\providecommand{\prch}{}\renewcommand{\prch}{perch}
\providecommand{\Prch}{}\renewcommand{\Prch}{Perch}
\providecommand{\prchs}{}\renewcommand{\prchs}{perches}
\providecommand{\Prchs}{}\renewcommand{\Prchs}{Perches}
\providecommand{\interval}{}\renewcommand{\interval}{period}
\providecommand{\Interval}{}\renewcommand{\Interval}{Period}
\providecommand{\intervals}{}\renewcommand{\intervals}{periods}
\providecommand{\Intervals}{}\renewcommand{\Intervals}{Periods}
\providecommand{\stg}{}\renewcommand{\stg}{stage}
\providecommand{\Stg}{}\renewcommand{\Stg}{Stage}
\providecommand{\stgs}{}\renewcommand{\stgs}{stages}
\providecommand{\Stgs}{}\renewcommand{\Stgs}{Stages}

% Transitions
\providecommand{\trnsn}{}\renewcommand{\trnsn}{transition}
\providecommand{\Trnsn}{}\renewcommand{\Trnsn}{Transition}
\providecommand{\trnsns}{}\renewcommand{\trnsns}{transitions}
\providecommand{\Trnsns}{}\renewcommand{\Trnsns}{Builders and Connectors}

% Evolutions
\providecommand{\evltn}{}\renewcommand{\evltn}{evolution}
\providecommand{\Evltn}{}\renewcommand{\Evltn}{Evolution}
\providecommand{\evltns}{}\renewcommand{\evltns}{evolutions}
\providecommand{\Evltns}{}\renewcommand{\Evltns}{Evolutions}

% Builders -- operators that connect stages or periods (build backward/forward)
% Subscripts name the two perches being built between (arvl = arrival, cntn = continuation).
% Backward builders operate on value functions (backward induction); forward on distributions (simulation).
\providecommand{\Cnct}{Connector}\renewcommand{\Cnct}{Connector}
\providecommand{\Cncts}{Connectors}\renewcommand{\Cncts}{Connectors}
% Connector: \Cnctr = mathematical (mathcal); \CnctrComp = computational (mathtt), used in SMD .tex
\providecommand{\Cnctr}{\mathcal{C}}\renewcommand{\Cnctr}{\mathcal{C}}
\providecommand{\CnctrComp}{}\renewcommand{\CnctrComp}{\mathtt{C}}
\providecommand{\BkBldr}{}\renewcommand{\BkBldr}{\mathtt{B}^{\leftarrow }}
\providecommand{\FwBldr}{}\renewcommand{\FwBldr}{\mathtt{B}^{\rightarrow}}
\providecommand{\BkBldrPrd}{}\renewcommand{\BkBldrPrd}{\mathtt{B}^{\leftarrow }_{\mathrm{prd}}}
\providecommand{\FwBldrPrd}{}\renewcommand{\FwBldrPrd}{\mathtt{B}^{\rightarrow}_{\mathrm{prd}}}
\providecommand{\BkBldrStg}{}\renewcommand{\BkBldrStg}{\mathtt{B}^{\leftarrow }_{\mathrm{stg}}}
\providecommand{\FwBldrStg}{}\renewcommand{\FwBldrStg}{\mathtt{B}^{\rightarrow}_{\mathrm{stg}}}

% Expectations -- primary use Arvl/Dcsn/Cntn
\newcommand{\ExCntn}{\Ex_{\Cntn}}
\newcommand{\ExDcsn}{\Ex_{\Dcsn}}
\newcommand{\ExArvl}{\Ex_{\Arvl}}
\newcommand{\ExBegPrd}{\Ex_{\BegPrd}}
\newcommand{\ExEndPrd}{\Ex_{\EndPrd}}
\providecommand{\stigma}{}\renewcommand{\stigma}{\varsigma}
\providecommand{\Shr}{}\renewcommand{\Shr}{\stigma}
\providecommand{\Aprx}{}\renewcommand{\Aprx}{\Alt}

% Portfolio-stage state variables are written inline as \check{\kNrm} and \check{\mNrm}
% (no macro needed; this keeps prettify-symbols working for the base letters)

\newcommand{\optml}[1]{\breve{#1}}

%\providecommand{\prdm}{}\renewcommand{\prdm}{({\prd-1})}

\newcommand{\code}[1]{\ensuremath{\mathtt{#1}}} % code should be in tt font

% These allow turning on or off the growth factor for permanent income
% (preserves symbolic derivations in LaTeX but makes them disappear)
% value function growth normed by G^{1-\CRRA}

% on
\newcommand{\PermGroFacAdjV}{\PermGroFac_{\prd}^{1-\CRRA}}
\newcommand{\PermGroFacAdjVNxt}{\PermGroFac_{\prd+1}^{1-\CRRA}}
\newcommand{\PermGroFacAdjMu}{\PermGroFac_{\prd}^{-\CRRA}}
\newcommand{\PermGroFacAdjMuNxt}{\PermGroFac_{\prd+1}^{-\CRRA}}
\newcommand{\AdjV}{_{\prd}^{1-\CRRA}}
\newcommand{\AdjVNxt}{_{\prd+1}^{1-\CRRA}}
\newcommand{\AdjMu}{_{\prd}^{-\CRRA}}
\newcommand{\AdjMuNxt}{_{\prd+1}^{-\CRRA}}
% off
\renewcommand{\PermGroFacAdjV}{\null}
\renewcommand{\PermGroFacAdjVNxt}{\null}
\renewcommand{\AdjV}{\null}
\renewcommand{\AdjVNxt}{\null}
\renewcommand{\AdjMu}{\null}
\renewcommand{\AdjMuNxt}{\null}
\renewcommand{\PermGroFacAdjMu}{\null}
\renewcommand{\PermGroFacAdjMuNxt}{\null}

% To compile the Habits subfile, go to the Subfiles directory

\newcommand{\trmT}{T}

\providecommand{\VInv}{}\providecommand{\VInv}{}\renewcommand{\VInv}{{\Lambda}}
\providecommand{\vInv}{}\providecommand{\vInv}{}\renewcommand{\vInv}{{\scriptstyle \VInv \displaystyle}}

\providecommand{\NatBoroCnstra}{}\providecommand{\NatBoroCnstra}{}\renewcommand{\NatBoroCnstra}{\underline{a}}

\providecommand{\DiscAlt}{}\renewcommand{\DiscAlt}{\beta} % Erase the distinction between the alternative and the standard discount factor

\providecommand{\aVecCode}{}\renewcommand{\aVecCode}{\code{aVec}}
\providecommand{\mVecCode}{}\renewcommand{\mVecCode}{\texttt{mVec}}
\providecommand{\kVecCode}{}\renewcommand{\kVecCode}{\texttt{kVec}}
\providecommand{\cVecCode}{}\renewcommand{\cVecCode}{\texttt{cVec}}

\newcommand{\vctr}[1]{\pmb{\mathtt{{#1}}}} % code should be in tt font
\newcommand{\vctrNotationDescribe}{a boldface monotype (computer) font}

%\newcommand{\vctr}{\mathtt}
\newcommand{\mVec}{\texttt{mVec}}
\newcommand{\aVec}{\texttt{aVec}}
\newcommand{\vVec}{\texttt{vVec}}

\newcommand{\stepShr}{\step[\Shr]}

%\newcommand{\vBegPrdNxt}{\vFunc_{_{\arvl}{\prd+1}}}
%\newcommand{\vMidPrdNxt}{\vFunc_{_{\dcsn}{\prd+1}}}
%\newcommand{\dvdShrBeg}{\vFunc^{\Shr}_{_{\arvl}\prd[\Shr]}}
\newcommand{\vShrBegPrd}{\vFunc^{\Shr}_{_{\arvl}\prd[\Shr]}}
\newcommand{\vShrMidPrd}{\vFunc^{\Shr}_{\prd[\Shr]}}
\newcommand{\vShrEndPrd}{\vFunc^{\Shr}_{\prd[\Shr]_{\cntn}}}
%\newcommand{\vVecShr}{\vctr{v}_{_{\arvl}\prd[\Shr]}}

\newcommand{\prdt}{t}
\newcommand{\prd}{\prdt} % alias: \prdt is canonical; \prd kept for backward compat
\newcommand{\prdT}{T}    % terminal period (renders as T when redefined)

\providecommand{\hEndMin}{\underline{\hNrm}}\renewcommand{\hEndMin}{\underline{\hNrm}}
\newcommand{\TranShkEmpDummy}{\pmb{\vartheta}}
\newcommand{\tranShkEmpDummy}{\vartheta}

\newcommand{\aVecMin}{{a}_{1}}
\newcommand{\cMin}{{c}_{1}}
\newcommand{\vctratm}{\vctr{a}_{\prd-1}}\renewcommand{\vctratm}{\vctr{a}}
\providecommand{\TranShkEmpMin}{}\renewcommand{\TranShkEmpMin}{\underline{\TranShkEmp}}
\providecommand{\tranShkEmpMin}{}\renewcommand{\tranShkEmpMin}{\underline{\tranShkEmp}}

%\newcommand{\cLst}{{c}_{\prdLst}}
%\newcommand{\cLsT}{{c}_{\prdLsT}}
%\newcommand{\mLst}{{m}_{\prdLst}}
%\newcommand{\mLsT}{{m}_{\prdLsT}}

% Alternative definitions of these would restore the time subscript for c
% in the max problem statements
%\newcommand{\cLvlMaxPrdT}{\cLvl}
%\newcommand{\cLvlMaxPrdt}{\cLvl}
%\newcommand{\cNrmMaxPrdT}{\cNrm}
%\newcommand{\cNrmMaxPrdt}{\cNrm}
% \newcommand{\cLvlMaxPrd}{\cLvl_{\prd}}

\providecommand{\std}{}\renewcommand{\std}{\sigma}
%\newcommand{\vrnc}{\std^{2}}

%\newcommand{\cStg}{\cFunc}
%\newcommand{\cStgSub}{[\cStg]}
%\newcommand{\cStgSup}{\cStg}

%\newcommand{\cStgBeg}{_{\arvl}{c}}
%\newcommand{\cStgMid}{[c]}
%\newcommand{\cStgEnd}{{c}\cntn}

%\newcommand{\mStte}{\mNrm} % m as a state variable
%\newcommand{\aStte}{\aNrm}
