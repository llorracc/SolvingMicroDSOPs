{
  "name": "SolvingMicroDSOPs (TeX Live 2025) - ${localWorkspaceFolderBasename}",
  "build": {
    "dockerfile": "../Dockerfile",
    "context": "..",
    "args": {
      "SST_FILE_PATH": "reproduce/required_latex_packages.txt"
    }
  },
  "runArgs": ["--entrypoint", ""],
  "workspaceFolder": "/workspace/${localWorkspaceFolderBasename}",
  "workspaceMount": "source=${localWorkspaceFolder},target=/workspace/${localWorkspaceFolderBasename},type=bind",
  "remoteUser": "vscode",

  "postCreateCommand": "bash .devcontainer/post-create.sh",

  "postStartCommand": [
    "bash", "-c",
    "export PATH=\"$HOME/.local/bin:$HOME/.cargo/bin:$PATH\"; ROOT=\"$(cat /workspace/*/.devcontainer/repo-root 2>/dev/null || cat /workspace/.devcontainer/repo-root 2>/dev/null)\"; [ -z \"$ROOT\" ] && ROOT=/workspace; ARCH=$(uname -m); VENV=\"$ROOT/.venv-linux-$ARCH\"; [ ! -f \"$VENV/bin/activate\" ] && VENV=\"$ROOT/.venv\"; if [ -f \"$VENV/bin/activate\" ]; then source \"$VENV/bin/activate\" && echo \"✅ Virtual environment: $(which python)\"; else echo \"⚠️  .venv not found - run: ./reproduce/reproduce_environment_comp_uv.sh\"; fi"
  ],

  "containerEnv": {
    "PYTHONUNBUFFERED": "1",
    "PATH": "/usr/local/texlive/2025/bin/aarch64-linux:/usr/local/texlive/2025/bin/x86_64-linux:/home/vscode/.local/bin:/home/vscode/.cargo/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
  },

  "forwardPorts": [8888, 8866],

  "portsAttributes": {
    "8888": {
      "label": "Jupyter Lab",
      "onAutoForward": "notify"
    },
    "8866": {
      "label": "Voila Dashboard",
      "onAutoForward": "ignore"
    }
  },

  "customizations": {
    "vscode": {
      "extensions": [
        "ms-python.python",
        "ms-python.debugpy",
        "ms-toolsai.jupyter",
        "ms-python.black-formatter",
        "ms-python.isort",
        "James-Yu.latex-workshop",
        "streetsidesoftware.code-spell-checker",
        "charliermarsh.ruff"
      ],
      "settings": {
        "python.defaultInterpreterPath": "${workspaceFolder}/.venv/bin/python",
        "python.venvPath": "${workspaceFolder}",
        "python.terminal.activateEnvironment": true,
        "latex-workshop.latex.outDir": "%DIR%",
        "latex-workshop.latex.tools": [
          {
            "name": "latexmk",
            "command": "latexmk",
            "args": [
              "-pdf",
              "-file-line-error",
              "-synctex=1",
              "-interaction=nonstopmode",
              "%DOC%"
            ]
          }
        ],
        "latex-workshop.latex.recipes": [
          {
            "name": "latexmk (SolvingMicroDSOPs)",
            "tools": ["latexmk"]
          }
        ],
        "latex-workshop.view.pdf.viewer": "tab",
        "files.watcherExclude": {
          "**/.git/objects/**": true,
          "**/.git/subtree-cache/**": true,
          "**/.venv*/**": true,
          "**/__pycache__/**": true
        }
      }
    }
  }
}
